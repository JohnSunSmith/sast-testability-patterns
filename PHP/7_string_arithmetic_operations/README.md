[//]: # (This file is automatically generated. If you wish to make any changes, please use the JSON files and regenerate this file using the tpframework.)

# String Arithmetic Operations

Tags: sast, php, php_v7.4.9

Version: v1.0

## Description

This pattern targets arithmetic operations performed on strings. Is a SAST tool able to capture the changed input?

## Overview

| Instances                   | has discovery rule   | discovery method   | rule successfull   |
|-----------------------------|----------------------|--------------------|--------------------|
| [1 Instance](#1-instance)   | yes                  | joern              | yes                |
| [2 Instance](#2-instance)   | yes                  | joern              | yes                |
| [3 Instance](#3-instance)   | yes                  | joern              | yes                |
| [4 Instance](#4-instance)   | yes                  | joern              | yes                |
| [5 Instance](#5-instance)   | yes                  | joern              | yes                |
| [6 Instance](#6-instance)   | yes                  | joern              | yes                |
| [7 Instance](#7-instance)   | yes                  | joern              | yes                |
| [8 Instance](#8-instance)   | yes                  | joern              | yes                |
| [9 Instance](#9-instance)   | yes                  | joern              | yes                |
| [10 Instance](#10-instance) | yes                  | joern              | yes                |
| [11 Instance](#11-instance) | yes                  | joern              | yes                |
| [12 Instance](#12-instance) | yes                  | joern              | yes                |

<details markdown="1"open>
<summary>

## 1 Instance
</summary>

This instance targets the usage of a post increment operator on a string.

### Code

```PHP
<?php
$a = $_GET["p1"]; // source
$a++; // tarpit
echo $a; // sink
```

### Instance Properties

| category   | feature_vs_internal_api   | input_sanitizer   | negative_test_case   | source_and_sink   |
|------------|---------------------------|-------------------|----------------------|-------------------|
| S0         | FEATURE                   | yes               | no                   | no                |

<details markdown="1">
<summary>
<b>More</b></summary>

<details markdown="1">
<summary>

### Compile
</summary>

```bash
$_main:
     ; (lines=6, args=0, vars=1, tmps=4)
     ; (before optimizer)
     ; /.../PHP/7_string_arithmetic_operations/1_instance_7_string_arithmetic_operations/1_instance_7_string_arithmetic_operations.php:1-4
     ; return  [] RANGE[0..0]
0000 T1 = FETCH_R (global) string("_GET")
0001 T2 = FETCH_DIM_R T1 string("p1")
0002 ASSIGN CV0($a) T2
0003 PRE_INC CV0($a)
0004 ECHO CV0($a)
0005 RETURN int(1)
```

</details>

<details markdown="1">
<summary>

### Discovery
</summary>

To be Perfect the discovery rule should be able to recognize when the variable, on which the operation is performed, is not a integer

```scala
val x7 = (name, "7_string_arithmetic_operations_i1", cpg.call(".*POST_INC.*").location.toJson);
```

| discovery method   | expected accuracy   |
|--------------------|---------------------|
| joern              | FP                  |

</details>

<details markdown="1"open>
<summary>

### Measurement
</summary>

| Tool        | Comm_1   | Comm_2   | phpSAFE   | Progpilot   | RIPS   | WAP   | Ground Truth   |
|-------------|----------|----------|-----------|-------------|--------|-------|----------------|
| 08 Jun 2021 | yes      | yes      | yes       | no          | yes    | yes   | yes            |
| 17 May 2023 | yes      |          |           |             |        |       | yes            |

</details>

</details>

</details>

<details markdown="1">
<summary>

## 2 Instance
</summary>

This instance targets the usage of a post decrement operator on a string.

### Code

```PHP
<?php
$a = $_GET["p1"]; // source
$a--; // tarpit
echo $a; // sink
```

### Instance Properties

| category   | feature_vs_internal_api   | input_sanitizer   | negative_test_case   | source_and_sink   |
|------------|---------------------------|-------------------|----------------------|-------------------|
| S0         | FEATURE                   | yes               | no                   | no                |

<details markdown="1">
<summary>
<b>More</b></summary>

<details markdown="1">
<summary>

### Compile
</summary>

```bash
$_main:
     ; (lines=6, args=0, vars=1, tmps=4)
     ; (before optimizer)
     ; /.../PHP/7_string_arithmetic_operations/2_instance_7_string_arithmetic_operations/2_instance_7_string_arithmetic_operations.php:1-4
     ; return  [] RANGE[0..0]
0000 T1 = FETCH_R (global) string("_GET")
0001 T2 = FETCH_DIM_R T1 string("p1")
0002 ASSIGN CV0($a) T2
0003 PRE_DEC CV0($a)
0004 ECHO CV0($a)
0005 RETURN int(1)
```

</details>

<details markdown="1">
<summary>

### Discovery
</summary>

To be Perfect the discovery rule should be able to recognize when the variable, on which the operation is performed, is not a integer

```scala
val x7 = (name, "7_string_arithmetic_operations_i2", cpg.call(".*POST_DEC.*").location.toJson);
```

| discovery method   | expected accuracy   |
|--------------------|---------------------|
| joern              | FP                  |

</details>

<details markdown="1"open>
<summary>

### Measurement
</summary>

| Tool        | Comm_1   | Comm_2   | phpSAFE   | Progpilot   | RIPS   | WAP   | Ground Truth   |
|-------------|----------|----------|-----------|-------------|--------|-------|----------------|
| 08 Jun 2021 | yes      | yes      | yes       | no          | yes    | yes   | yes            |
| 17 May 2023 | yes      | yes      |           |             |        |       | yes            |

</details>

</details>

</details>

<details markdown="1">
<summary>

## 3 Instance
</summary>

This instance targets the usage of a pre increment operator on a string.

### Code

```PHP
<?php
$a = $_GET["p1"]; // source
++$a; // tarpit
echo $a; // sink
```

### Instance Properties

| category   | feature_vs_internal_api   | input_sanitizer   | negative_test_case   | source_and_sink   |
|------------|---------------------------|-------------------|----------------------|-------------------|
| S0         | FEATURE                   | yes               | no                   | no                |

<details markdown="1">
<summary>
<b>More</b></summary>

<details markdown="1">
<summary>

### Compile
</summary>

```bash
$_main:
     ; (lines=6, args=0, vars=1, tmps=4)
     ; (before optimizer)
     ; /.../PHP/7_string_arithmetic_operations/3_instance_7_string_arithmetic_operations/3_instance_7_string_arithmetic_operations.php:1-4
     ; return  [] RANGE[0..0]
0000 T1 = FETCH_R (global) string("_GET")
0001 T2 = FETCH_DIM_R T1 string("p1")
0002 ASSIGN CV0($a) T2
0003 PRE_INC CV0($a)
0004 ECHO CV0($a)
0005 RETURN int(1)
```

</details>

<details markdown="1">
<summary>

### Discovery
</summary>

To be Perfect the discovery rule should be able to recognize when the variable, on which the operation is performed, is not a integer

```scala
val x7 = (name, "7_string_arithmetic_operations_i3", cpg.call(".*PRE_INC.*").location.toJson);
```

| discovery method   | expected accuracy   |
|--------------------|---------------------|
| joern              | FP                  |

</details>

<details markdown="1"open>
<summary>

### Measurement
</summary>

| Tool        | Comm_1   | Comm_2   | phpSAFE   | Progpilot   | RIPS   | WAP   | Ground Truth   |
|-------------|----------|----------|-----------|-------------|--------|-------|----------------|
| 08 Jun 2021 | yes      | yes      | yes       | no          | yes    | yes   | yes            |
| 17 May 2023 | yes      | yes      |           |             |        |       | yes            |

</details>

</details>

</details>

<details markdown="1">
<summary>

## 4 Instance
</summary>

This instance targets the usage of a pre decrement operator on a string.

### Code

```PHP
<?php
$a = $_GET["p1"]; // source
--$a; // tarpit
echo $a; // sink
```

### Instance Properties

| category   | feature_vs_internal_api   | input_sanitizer   | negative_test_case   | source_and_sink   |
|------------|---------------------------|-------------------|----------------------|-------------------|
| S0         | FEATURE                   | yes               | no                   | no                |

<details markdown="1">
<summary>
<b>More</b></summary>

<details markdown="1">
<summary>

### Compile
</summary>

```bash
$_main:
     ; (lines=6, args=0, vars=1, tmps=4)
     ; (before optimizer)
     ; /.../PHP/7_string_arithmetic_operations/4_instance_7_string_arithmetic_operations/4_instance_7_string_arithmetic_operations.php:1-4
     ; return  [] RANGE[0..0]
0000 T1 = FETCH_R (global) string("_GET")
0001 T2 = FETCH_DIM_R T1 string("p1")
0002 ASSIGN CV0($a) T2
0003 PRE_DEC CV0($a)
0004 ECHO CV0($a)
0005 RETURN int(1)
```

</details>

<details markdown="1">
<summary>

### Discovery
</summary>

To be Perfect the discovery rule should be able to recognize when the variable, on which the operation is performed, is not a integer

```scala
val x7 = (name, "7_string_arithmetic_operations_i4", cpg.call(".*PRE_DEC.*").location.toJson);
```

| discovery method   | expected accuracy   |
|--------------------|---------------------|
| joern              | FP                  |

</details>

<details markdown="1"open>
<summary>

### Measurement
</summary>

| Tool        | Comm_1   | Comm_2   | phpSAFE   | Progpilot   | RIPS   | WAP   | Ground Truth   |
|-------------|----------|----------|-----------|-------------|--------|-------|----------------|
| 08 Jun 2021 | yes      | yes      | yes       | no          | yes    | yes   | yes            |
| 17 May 2023 | yes      | yes      |           |             |        |       | yes            |

</details>

</details>

</details>

<details markdown="1">
<summary>

## 5 Instance
</summary>

This instance targets the usage of a pre decrement operator on a static variable of a class, which contains a string.

### Code

```PHP
<?php
class static_class{
	public static $a;
}

$a = $_GET["p1"]; // source
static_class::$a = $a;
--static_class::$a; // tarpit
echo static_class::$a; // sink
```

### Instance Properties

| category   | feature_vs_internal_api   | input_sanitizer   | negative_test_case   | source_and_sink   |
|------------|---------------------------|-------------------|----------------------|-------------------|
| S0         | FEATURE                   | yes               | no                   | no                |

<details markdown="1">
<summary>
<b>More</b></summary>

<details markdown="1">
<summary>

### Compile
</summary>

```bash
$_main:
     ; (lines=9, args=0, vars=1, tmps=6)
     ; (before optimizer)
     ; /.../PHP/7_string_arithmetic_operations/5_instance_7_string_arithmetic_operations/5_instance_7_string_arithmetic_operations.php:1-9
     ; return  [] RANGE[0..0]
0000 T1 = FETCH_R (global) string("_GET")
0001 T2 = FETCH_DIM_R T1 string("p1")
0002 ASSIGN CV0($a) T2
0003 ASSIGN_STATIC_PROP string("a") string("static_class")
0004 OP_DATA CV0($a)
0005 PRE_DEC_STATIC_PROP string("a") string("static_class")
0006 T6 = FETCH_STATIC_PROP_R string("a") string("static_class")
0007 ECHO T6
0008 RETURN int(1)
```

</details>

<details markdown="1">
<summary>

### Discovery
</summary>

To be Perfect the discovery rule should be able to recognize when the variable, on which the operation is performed, is not a integer

```scala
val x7 = (name, "7_string_arithmetic_operations_i5", cpg.call(".*PRE_DEC_STATIC_PROP.*").location.toJson);
```

| discovery method   | expected accuracy   |
|--------------------|---------------------|
| joern              | FP                  |

</details>

<details markdown="1"open>
<summary>

### Measurement
</summary>

| Tool        | Comm_1   | Comm_2   | phpSAFE   | Progpilot   | RIPS   | WAP   | Ground Truth   |
|-------------|----------|----------|-----------|-------------|--------|-------|----------------|
| 08 Jun 2021 | yes      | yes      | yes       | no          | yes    | yes   | yes            |
| 17 May 2023 | yes      | yes      |           |             |        |       | yes            |

</details>

</details>

</details>

<details markdown="1">
<summary>

## 6 Instance
</summary>

This instance targets the usage of a pre increment operator on a static variable of a class, which contains a string.

### Code

```PHP
<?php
class static_class {
	public static $a;
}

$a = $_GET["p1"]; // source
static_class::$a = $a;
++static_class::$a; // tarpit
echo static_class::$a; // sink
```

### Instance Properties

| category   | feature_vs_internal_api   | input_sanitizer   | negative_test_case   | source_and_sink   |
|------------|---------------------------|-------------------|----------------------|-------------------|
| S0         | FEATURE                   | yes               | no                   | no                |

<details markdown="1">
<summary>
<b>More</b></summary>

<details markdown="1">
<summary>

### Compile
</summary>

```bash
$_main:
     ; (lines=9, args=0, vars=1, tmps=6)
     ; (before optimizer)
     ; /.../PHP/7_string_arithmetic_operations/6_instance_7_string_arithmetic_operations/6_instance_7_string_arithmetic_operations.php:1-9
     ; return  [] RANGE[0..0]
0000 T1 = FETCH_R (global) string("_GET")
0001 T2 = FETCH_DIM_R T1 string("p1")
0002 ASSIGN CV0($a) T2
0003 ASSIGN_STATIC_PROP string("a") string("static_class")
0004 OP_DATA CV0($a)
0005 PRE_INC_STATIC_PROP string("a") string("static_class")
0006 T6 = FETCH_STATIC_PROP_R string("a") string("static_class")
0007 ECHO T6
0008 RETURN int(1)
```

</details>

<details markdown="1">
<summary>

### Discovery
</summary>

To be Perfect the discovery rule should be able to recognize when the variable, on which the operation is performed, is not a integer

```scala
val x7 = (name, "7_string_arithmetic_operations_i6", cpg.call(".*PRE_INC_STATIC_PROP.*").location.toJson);
```

| discovery method   | expected accuracy   |
|--------------------|---------------------|
| joern              | FP                  |

</details>

<details markdown="1"open>
<summary>

### Measurement
</summary>

| Tool        | Comm_1   | Comm_2   | phpSAFE   | Progpilot   | RIPS   | WAP   | Ground Truth   |
|-------------|----------|----------|-----------|-------------|--------|-------|----------------|
| 08 Jun 2021 | yes      | yes      | yes       | no          | yes    | yes   | yes            |
| 17 May 2023 | yes      | yes      |           |             |        |       | yes            |

</details>

</details>

</details>

<details markdown="1">
<summary>

## 7 Instance
</summary>

This instance targets the usage of a post decrement operator on a static variable of a class, which contains a string.

### Code

```PHP
<?php
class static_class {
	public static $a;
}

$a = $_GET["p1"]; // source
static_class::$a = $a;
static_class::$a--; // tarpit
echo static_class::$a; // sink
```

### Instance Properties

| category   | feature_vs_internal_api   | input_sanitizer   | negative_test_case   | source_and_sink   |
|------------|---------------------------|-------------------|----------------------|-------------------|
| S0         | FEATURE                   | yes               | no                   | no                |

<details markdown="1">
<summary>
<b>More</b></summary>

<details markdown="1">
<summary>

### Compile
</summary>

```bash
$_main:
     ; (lines=9, args=0, vars=1, tmps=6)
     ; (before optimizer)
     ; /.../PHP/7_string_arithmetic_operations/7_instance_7_string_arithmetic_operations/7_instance_7_string_arithmetic_operations.php:1-9
     ; return  [] RANGE[0..0]
0000 T1 = FETCH_R (global) string("_GET")
0001 T2 = FETCH_DIM_R T1 string("p1")
0002 ASSIGN CV0($a) T2
0003 ASSIGN_STATIC_PROP string("a") string("static_class")
0004 OP_DATA CV0($a)
0005 PRE_DEC_STATIC_PROP string("a") string("static_class")
0006 T6 = FETCH_STATIC_PROP_R string("a") string("static_class")
0007 ECHO T6
0008 RETURN int(1)
```

</details>

<details markdown="1">
<summary>

### Discovery
</summary>

To be Perfect the discovery rule should be able to recognize when the variable, on which the operation is performed, is not a integer

```scala
val x7 = (name, "7_string_arithmetic_operations_i7", cpg.call(".*POST_DEC_STATIC_PROP.*").location.toJson);
```

| discovery method   | expected accuracy   |
|--------------------|---------------------|
| joern              | FP                  |

</details>

<details markdown="1"open>
<summary>

### Measurement
</summary>

| Tool        | Comm_1   | Comm_2   | phpSAFE   | Progpilot   | RIPS   | WAP   | Ground Truth   |
|-------------|----------|----------|-----------|-------------|--------|-------|----------------|
| 08 Jun 2021 | yes      | yes      | yes       | no          | yes    | yes   | yes            |
| 17 May 2023 | yes      | yes      |           |             |        |       | yes            |

</details>

</details>

</details>

<details markdown="1">
<summary>

## 8 Instance
</summary>

This instance targets the usage of a post increment operator on a static variable of a class, which contains a string.

### Code

```PHP
<?php
class static_class {
	public static $a;
}

$a = $_GET["p1"]; // source
static_class::$a = $a;
static_class::$a++; // tarpit
echo static_class::$a; // sink
```

### Instance Properties

| category   | feature_vs_internal_api   | input_sanitizer   | negative_test_case   | source_and_sink   |
|------------|---------------------------|-------------------|----------------------|-------------------|
| S0         | FEATURE                   | yes               | no                   | no                |

<details markdown="1">
<summary>
<b>More</b></summary>

<details markdown="1">
<summary>

### Compile
</summary>

```bash
$_main:
     ; (lines=9, args=0, vars=1, tmps=6)
     ; (before optimizer)
     ; /.../PHP/7_string_arithmetic_operations/8_instance_7_string_arithmetic_operations/8_instance_7_string_arithmetic_operations.php:1-9
     ; return  [] RANGE[0..0]
0000 T1 = FETCH_R (global) string("_GET")
0001 T2 = FETCH_DIM_R T1 string("p1")
0002 ASSIGN CV0($a) T2
0003 ASSIGN_STATIC_PROP string("a") string("static_class")
0004 OP_DATA CV0($a)
0005 PRE_INC_STATIC_PROP string("a") string("static_class")
0006 T6 = FETCH_STATIC_PROP_R string("a") string("static_class")
0007 ECHO T6
0008 RETURN int(1)
```

</details>

<details markdown="1">
<summary>

### Discovery
</summary>

To be Perfect the discovery rule should be able to recognize when the variable, on which the operation is performed, is not a integer

```scala
val x7 = (name, "7_string_arithmetic_operations_i8", cpg.call(".*POST_INC_STATIC_PROP.*").location.toJson);
```

| discovery method   | expected accuracy   |
|--------------------|---------------------|
| joern              | FP                  |

</details>

<details markdown="1"open>
<summary>

### Measurement
</summary>

| Tool        | Comm_1   | Comm_2   | phpSAFE   | Progpilot   | RIPS   | WAP   | Ground Truth   |
|-------------|----------|----------|-----------|-------------|--------|-------|----------------|
| 08 Jun 2021 | yes      | yes      | yes       | no          | yes    | yes   | yes            |
| 17 May 2023 | yes      | yes      |           |             |        |       | yes            |

</details>

</details>

</details>

<details markdown="1">
<summary>

## 9 Instance
</summary>

This instance targets the usage of a pre decrement operator on an instance variable of a class incstance, which contains a string.

### Code

```PHP
<?php
class myclass {
	public $a;
}

$a = $_GET["p1"]; // source
$obj = new myclass();
$obj->a = $a;
--$obj->a; // tarpit
echo $obj->a; // sink
```

### Instance Properties

| category   | feature_vs_internal_api   | input_sanitizer   | negative_test_case   | source_and_sink   |
|------------|---------------------------|-------------------|----------------------|-------------------|
| S0         | FEATURE                   | yes               | no                   | no                |

<details markdown="1">
<summary>
<b>More</b></summary>

<details markdown="1">
<summary>

### Compile
</summary>

```bash
$_main:
     ; (lines=12, args=0, vars=2, tmps=9)
     ; (before optimizer)
     ; /.../PHP/7_string_arithmetic_operations/9_instance_7_string_arithmetic_operations/9_instance_7_string_arithmetic_operations.php:1-10
     ; return  [] RANGE[0..0]
0000 T2 = FETCH_R (global) string("_GET")
0001 T3 = FETCH_DIM_R T2 string("p1")
0002 ASSIGN CV0($a) T3
0003 V5 = NEW 0 string("myclass")
0004 DO_FCALL
0005 ASSIGN CV1($obj) V5
0006 ASSIGN_OBJ CV1($obj) string("a")
0007 OP_DATA CV0($a)
0008 PRE_DEC_OBJ CV1($obj) string("a")
0009 T10 = FETCH_OBJ_R CV1($obj) string("a")
0010 ECHO T10
0011 RETURN int(1)
LIVE RANGES:
     5: 0004 - 0005 (new)
```

</details>

<details markdown="1">
<summary>

### Discovery
</summary>

To be Perfect the discovery rule should be able to recognize when the variable, on which the operation is performed, is not a integer

```scala
val x7 = (name, "7_string_arithmetic_operations_i9", cpg.call(".*PRE_DEC_OBJ.*").location.toJson);
```

| discovery method   | expected accuracy   |
|--------------------|---------------------|
| joern              | FP                  |

</details>

<details markdown="1"open>
<summary>

### Measurement
</summary>

| Tool        | Comm_1   | Comm_2   | phpSAFE   | Progpilot   | RIPS   | WAP   | Ground Truth   |
|-------------|----------|----------|-----------|-------------|--------|-------|----------------|
| 08 Jun 2021 | yes      | yes      | yes       | no          | yes    | yes   | yes            |
| 17 May 2023 | yes      | yes      |           |             |        |       | yes            |

</details>

</details>

</details>

<details markdown="1">
<summary>

## 10 Instance
</summary>

This instance targets the usage of a pre increment operator on an instance variable of a class incstance, which contains a string.

### Code

```PHP
<?php
class myclass {
	public $a;
}

$a = $_GET["p1"]; // source
$obj = new myclass();
$obj->a = $a;
++$obj->a; // tarpit
echo $obj->a; // sink
```

### Instance Properties

| category   | feature_vs_internal_api   | input_sanitizer   | negative_test_case   | source_and_sink   |
|------------|---------------------------|-------------------|----------------------|-------------------|
| S0         | FEATURE                   | yes               | no                   | no                |

<details markdown="1">
<summary>
<b>More</b></summary>

<details markdown="1">
<summary>

### Compile
</summary>

```bash
$_main:
     ; (lines=12, args=0, vars=2, tmps=9)
     ; (before optimizer)
     ; /.../PHP/7_string_arithmetic_operations/10_instance_7_string_arithmetic_operations/10_instance_7_string_arithmetic_operations.php:1-10
     ; return  [] RANGE[0..0]
0000 T2 = FETCH_R (global) string("_GET")
0001 T3 = FETCH_DIM_R T2 string("p1")
0002 ASSIGN CV0($a) T3
0003 V5 = NEW 0 string("myclass")
0004 DO_FCALL
0005 ASSIGN CV1($obj) V5
0006 ASSIGN_OBJ CV1($obj) string("a")
0007 OP_DATA CV0($a)
0008 PRE_INC_OBJ CV1($obj) string("a")
0009 T10 = FETCH_OBJ_R CV1($obj) string("a")
0010 ECHO T10
0011 RETURN int(1)
LIVE RANGES:
     5: 0004 - 0005 (new)
```

</details>

<details markdown="1">
<summary>

### Discovery
</summary>

To be Perfect the discovery rule should be able to recognize when the variable, on which the operation is performed, is not a integer

```scala
val x7 = (name, "7_string_arithmetic_operations_i10", cpg.call(".*PRE_INC_OBJ.*").location.toJson);
```

| discovery method   | expected accuracy   |
|--------------------|---------------------|
| joern              | FP                  |

</details>

<details markdown="1"open>
<summary>

### Measurement
</summary>

| Tool        | Comm_1   | Comm_2   | phpSAFE   | Progpilot   | RIPS   | WAP   | Ground Truth   |
|-------------|----------|----------|-----------|-------------|--------|-------|----------------|
| 08 Jun 2021 | yes      | yes      | yes       | no          | yes    | yes   | yes            |
| 17 May 2023 | yes      | yes      |           |             |        |       | yes            |

</details>

</details>

</details>

<details markdown="1">
<summary>

## 11 Instance
</summary>

This instance targets the usage of a post decrement operator on an instance variable of a class incstance, which contains a string.

### Code

```PHP
<?php
class myclass {
	public $a;
}

$a = $_GET["p1"]; // source
$obj = new myclass();
$obj->a = $a;
$obj->a--; // tarpit
echo $obj->a; // sink
```

### Instance Properties

| category   | feature_vs_internal_api   | input_sanitizer   | negative_test_case   | source_and_sink   |
|------------|---------------------------|-------------------|----------------------|-------------------|
| S0         | FEATURE                   | yes               | no                   | no                |

<details markdown="1">
<summary>
<b>More</b></summary>

<details markdown="1">
<summary>

### Compile
</summary>

```bash
$_main:
     ; (lines=12, args=0, vars=2, tmps=9)
     ; (before optimizer)
     ; /.../PHP/7_string_arithmetic_operations/11_instance_7_string_arithmetic_operations/11_instance_7_string_arithmetic_operations.php:1-10
     ; return  [] RANGE[0..0]
0000 T2 = FETCH_R (global) string("_GET")
0001 T3 = FETCH_DIM_R T2 string("p1")
0002 ASSIGN CV0($a) T3
0003 V5 = NEW 0 string("myclass")
0004 DO_FCALL
0005 ASSIGN CV1($obj) V5
0006 ASSIGN_OBJ CV1($obj) string("a")
0007 OP_DATA CV0($a)
0008 PRE_DEC_OBJ CV1($obj) string("a")
0009 T10 = FETCH_OBJ_R CV1($obj) string("a")
0010 ECHO T10
0011 RETURN int(1)
LIVE RANGES:
     5: 0004 - 0005 (new)
```

</details>

<details markdown="1">
<summary>

### Discovery
</summary>

To be Perfect the discovery rule should be able to recognize when the variable, on which the operation is performed, is not a integer

```scala
val x7 = (name, "7_string_arithmetic_operations_i11", cpg.call(".*POST_DEC_OBJ.*").location.toJson);
```

| discovery method   | expected accuracy   |
|--------------------|---------------------|
| joern              | FP                  |

</details>

<details markdown="1"open>
<summary>

### Measurement
</summary>

| Tool        | Comm_1   | Comm_2   | phpSAFE   | Progpilot   | RIPS   | WAP   | Ground Truth   |
|-------------|----------|----------|-----------|-------------|--------|-------|----------------|
| 08 Jun 2021 | yes      | yes      | yes       | no          | yes    | yes   | yes            |
| 17 May 2023 | yes      | yes      |           |             |        |       | yes            |

</details>

</details>

</details>

<details markdown="1">
<summary>

## 12 Instance
</summary>

This instance targets the usage of a post increment operator on an instance variable of a class incstance, which contains a string.

### Code

```PHP
<?php
class myclass {
	public $a;
}

$a = $_GET["p1"]; // source
$obj = new myclass();
$obj->a = $a;
$obj->a++; // tarpit
echo $obj->a; // sink
```

### Instance Properties

| category   | feature_vs_internal_api   | input_sanitizer   | negative_test_case   | source_and_sink   |
|------------|---------------------------|-------------------|----------------------|-------------------|
| S0         | FEATURE                   | yes               | no                   | no                |

<details markdown="1">
<summary>
<b>More</b></summary>

<details markdown="1">
<summary>

### Compile
</summary>

```bash
$_main:
     ; (lines=12, args=0, vars=2, tmps=9)
     ; (before optimizer)
     ; /.../PHP/7_string_arithmetic_operations/12_instance_7_string_arithmetic_operations/12_instance_7_string_arithmetic_operations.php:1-10
     ; return  [] RANGE[0..0]
0000 T2 = FETCH_R (global) string("_GET")
0001 T3 = FETCH_DIM_R T2 string("p1")
0002 ASSIGN CV0($a) T3
0003 V5 = NEW 0 string("myclass")
0004 DO_FCALL
0005 ASSIGN CV1($obj) V5
0006 ASSIGN_OBJ CV1($obj) string("a")
0007 OP_DATA CV0($a)
0008 PRE_INC_OBJ CV1($obj) string("a")
0009 T10 = FETCH_OBJ_R CV1($obj) string("a")
0010 ECHO T10
0011 RETURN int(1)
LIVE RANGES:
     5: 0004 - 0005 (new)
```

</details>

<details markdown="1">
<summary>

### Discovery
</summary>

To be Perfect the discovery rule should be able to recognize when the variable, on which the operation is performed, is not a integer

```scala
val x7 = (name, "7_string_arithmetic_operations_i12", cpg.call(".*POST_INC_OBJ.*").location.toJson);
```

| discovery method   | expected accuracy   |
|--------------------|---------------------|
| joern              | FP                  |

</details>

<details markdown="1"open>
<summary>

### Measurement
</summary>

| Tool        | Comm_1   | Comm_2   | phpSAFE   | Progpilot   | RIPS   | WAP   | Ground Truth   |
|-------------|----------|----------|-----------|-------------|--------|-------|----------------|
| 08 Jun 2021 | yes      | yes      | yes       | no          | yes    | yes   | yes            |
| 17 May 2023 | yes      | yes      |           |             |        |       | yes            |

</details>

</details>

</details>
